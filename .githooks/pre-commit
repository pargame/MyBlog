#!/usr/bin/env bash
# Run ESLint and Prettier on staged files
set -e

# Get staged files
STAGED=$(git diff --cached --name-only --diff-filter=ACM | grep -E "\.(js|jsx|ts|tsx|md|css|json)$" || true)
if [ -z "$STAGED" ]; then
  echo "No relevant staged files. Skipping pre-commit checks."
  exit 0
fi

# Run eslint --fix and prettier for these files
echo "Running eslint --fix on staged files..."
# Use npx so that local node_modules bin is used
npx eslint --fix $STAGED || true

echo "Running prettier --write on staged files..."
npx prettier --write $STAGED || true

# Re-add potentially modified files
git add $STAGED

echo "pre-commit checks complete."
